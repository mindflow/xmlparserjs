import{Logger,Map,StringUtils,List}from"./coreutil_v1.js";class ReadAhead{static read(t,e,n,i=!1){let r=n;for(let n=0;n<e.length&&n<t.length;n++){for(;i&&" "==t.charAt(r);)r++;if(t.charAt(r)!=e.charAt(n))return-1;r++}return r-1}}class XmlAttribute{constructor(t,e,n){this.name=t,this.namespace=e,this.value=n}getName(){return this.name}setName(t){this.name=t}getNamespace(){return this.namespace}setNamespace(t){this.namespace=t}getValue(){return this.value}setValue(t){this.value=t}}const LOG=new Logger("ElementBody");class ElementBody{constructor(){this.name=null,this.namespace=null,this.attributes=new Map}getName(){return this.name}getNamespace(){return this.namespace}getAttributes(){return this.attributes}detectPositions(t,e,n){let i=n,r=null;for(;StringUtils.isInAlphabet(e.charAt(n))&&n<e.length;)n++;if(":"==e.charAt(n))for(LOG.debug(t,"Found namespace"),n++;StringUtils.isInAlphabet(e.charAt(n))&&n<e.length;)n++;return r=n-1,this.name=e.substring(i,r+1),this.name.indexOf(":")>-1&&(this.namespace=this.name.split(":")[0],this.name=this.name.split(":")[1]),n=this.detectAttributes(t,e,n)}detectAttributes(t,e,n){let i=null;for(;-1!=(i=this.detectNextStartAttribute(t,e,n));){n=this.detectNextEndAttribute(t,e,i);let r=null,s=e.substring(i,n+1);s.indexOf(":")>-1&&(r=s.split(":")[0],s=s.split(":")[1]),LOG.debug(t,"Found attribute from "+i+"  to "+n),n=this.detectValue(s,r,t,e,n+1)}return n}detectNextStartAttribute(t,e,n){for(;" "==e.charAt(n)&&n<e.length;)if(n++,StringUtils.isInAlphabet(e.charAt(n))||"-"===e.charAt(n))return n;return-1}detectNextEndAttribute(t,e,n){for(;StringUtils.isInAlphabet(e.charAt(n))||"-"===e.charAt(n);)n++;if(":"==e.charAt(n))for(n++;StringUtils.isInAlphabet(e.charAt(n))||"-"===e.charAt(n);)n++;return n-1}detectValue(t,e,n,i,r){let s=r,o=t;if(null!==e&&(o=e+":"+t),-1==(s=ReadAhead.read(i,'="',s,!0)))return this.attributes.set(o,new XmlAttribute(t,e,null)),r;s++,LOG.debug(n,"Possible attribute value start at "+s);let u=s;for(;this.isAttributeContent(n,i,s);)s++;return s==r?this.attributes.set(o,new XmlAttribute(t,e,"")):this.attributes.set(o,new XmlAttribute(t,e,i.substring(u,s))),LOG.debug(n,"Found attribute content ending at "+(s-1)),-1!=(s=ReadAhead.read(i,'"',s,!0))?s++:LOG.error("Missing end quotes on attribute at position "+s),s}isAttributeContent(t,e,n){return-1==ReadAhead.read(e,"<",n)&&(-1==ReadAhead.read(e,">",n)&&-1==ReadAhead.read(e,'"',n))}}const LOG$1=new Logger("XmlCdata");class XmlCdata{constructor(t){this.value=t}setValue(t){this.value=t}getValue(){return this.value}dump(){this.dumpLevel(0)}dumpLevel(t){let e=":";for(let n=0;n<2*t;n++)e+=" ";LOG$1.info(e+this.value)}read(){return this.value}}const LOG$2=new Logger("XmlElement");class XmlElement{constructor(t,e,n,i){this.name=t,this.namespace=e,this.selfClosing=i,this.childElements=new List,this.attributes=new Map,this.namespaceUri=n}getName(){return this.name}getNamespace(){return this.namespace}getNamespaceUri(){return this.namespaceUri}getFullName(){return null===this.namespace?this.name:this.namespace+":"+this.name}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t}setAttribute(t,e){this.attributes.set(t,e)}getAttribute(t){return this.attributes.get(t)}containsAttribute(t){return this.attributes.contains(t)}clearAttribute(){this.attributes=new Map}getChildElements(){return this.childElements}setChildElements(t){this.childElements=t}setText(t){this.childElements=new List,this.addText(t)}addText(t){let e=new XmlCdata(t);this.childElements.add(e)}dump(){this.dumpLevel(0)}dumpLevel(t){let e=":";for(let n=0;n<2*t;n++)e+=" ";if(this.selfClosing)return void LOG$2.info(e+"<"+this.getFullName()+this.readAttributes()+"/>");LOG$2.info(e+"<"+this.getFullName()+this.readAttributes()+">"),this.childElements.forEach(function(e){return e.dumpLevel(t+1),!0}),LOG$2.info(e+"</"+this.getFullName()+">")}read(){let t="";return this.selfClosing?t=t+"<"+this.getFullName()+this.readAttributes()+"/>":(t=t+"<"+this.getFullName()+this.readAttributes()+">",this.childElements.forEach(function(e){return t+=e.read(),!0}),t=t+"</"+this.getFullName()+">")}readAttributes(){let t="";return this.attributes.forEach(function(e,n,i){let r=n.getName();return null!==n.getNamespace()&&(r=n.getNamespace()+":"+n.getName()),t=t+" "+r,null!==n.getValue()&&(t=t+'="'+n.getValue()+'"'),!0},this),t}}const LOG$3=new Logger("ElementDetector");class ElementDetector{constructor(t){this.type="ElementDetector",this.namespaceUriMap=t,this.children=!1,this.found=!1,this.xmlCursor=null,this.element=null}createElement(){return this.element}getType(){return this.type}isFound(){return this.found}hasChildren(){return this.children}detect(t,e){this.xmlCursor=e,LOG$3.debug(t,"Looking for opening element at position "+e.cursor);let n=new ElementBody,i=ElementDetector.detectOpenElement(t,e.xml,e.cursor,n);if(-1!=i){let r=null;null!==n.getNamespace()&&void 0!==n.getNamespace()&&(r=this.namespaceUriMap.get(n.getNamespace())),this.element=new XmlElement(n.getName(),n.getNamespace(),r,!1),n.getAttributes().forEach(function(t,e,n){return n.element.getAttributes().set(t,e),!0},this),LOG$3.debug(t,"Found opening tag <"+this.element.getFullName()+"> from "+e.cursor+" to "+i),e.cursor=i+1,this.stop(t)||(this.children=!0),this.found=!0}}stop(t){LOG$3.debug(t,"Looking for closing element at position "+this.xmlCursor.cursor);let e=ElementDetector.detectEndElement(t,this.xmlCursor.xml,this.xmlCursor.cursor);if(-1!=e){let n=this.xmlCursor.xml.substring(this.xmlCursor.cursor+2,e);return LOG$3.debug(t,"Found closing tag </"+n+"> from "+this.xmlCursor.cursor+" to "+e),this.element.getFullName()!=n&&LOG$3.error("ERR: Mismatch between opening tag <"+this.element.getFullName()+"> and closing tag </"+n+"> When exiting to parent elemnt"),this.xmlCursor.cursor=e+1,!0}return!1}static detectOpenElement(t,e,n,i){return-1==(n=ReadAhead.read(e,"<",n))?-1:(n++,n=i.detectPositions(t+1,e,n),-1==(n=ReadAhead.read(e,">",n,!0))?-1:n)}static detectEndElement(t,e,n){return-1==(n=ReadAhead.read(e,"</",n))?-1:(n++,n=(new ElementBody).detectPositions(t+1,e,n),-1==(n=ReadAhead.read(e,">",n,!0))?-1:n)}}const LOG$4=new Logger("CdataDetector");class CdataDetector{constructor(){this.type="CdataDetector",this.value=null,this.found=!1}isFound(){return this.found}getType(){return this.type}createElement(){return new XmlCdata(this.value)}detect(t,e){this.found=!1,this.value=null;let n=this.detectContent(t,e.xml,e.cursor,e.parentDomScaffold);-1!=n&&(this.found=!0,this.hasChildren=!1,this.value=e.xml.substring(e.cursor,n),e.cursor=n)}detectContent(t,e,n,i){LOG$4.debug(t,"Cdata start at "+n);let r=n;if(!CdataDetector.isContent(t,e,n))return LOG$4.debug(t,"No Cdata found"),-1;for(;CdataDetector.isContent(t,e,n)&&n<e.length;)n++;return LOG$4.debug(t,"Cdata end at "+(n-1)),null===i?(LOG$4.error("ERR: Content not allowed on root level in xml document"),-1):(LOG$4.debug(t,"Cdata found value is "+e.substring(r,n)),n)}static isContent(t,e,n){return-1==ReadAhead.read(e,"<",n)&&-1==ReadAhead.read(e,">",n)}}const LOG$5=new Logger("ClosingElementDetector");class ClosingElementDetector{constructor(t){this.type="ClosingElementDetector",this.namespaceUriMap=t,this.found=!1,this.element=null}createElement(){return this.element}getType(){return this.type}isFound(){return this.found}detect(t,e){LOG$5.debug(t,"Looking for self closing element at position "+e.cursor);let n=new ElementBody,i=ClosingElementDetector.detectClosingElement(t,e.xml,e.cursor,n);-1!=i&&(this.element=new XmlElement(n.getName(),n.getNamespace(),this.namespaceUriMap,!0),n.getAttributes().forEach(function(t,e,n){return n.element.setAttribute(t,e),!0},this),LOG$5.debug(t,"Found self closing tag <"+this.element.getFullName()+"/> from "+e.cursor+" to "+i),this.found=!0,e.cursor=i+1)}static detectClosingElement(t,e,n,i){return-1==(n=ReadAhead.read(e,"<",n))?-1:(n++,n=i.detectPositions(t+1,e,n),-1==(n=ReadAhead.read(e,"/>",n))?-1:n)}}class XmlCursor{constructor(t,e,n){this.xml=t,this.cursor=e,this.parentDomScaffold=n}eof(){return this.cursor>=this.xml.length}}const LOG$6=new Logger("DomScaffold");class DomScaffold{constructor(t){this.namespaceUriMap=t,this.element=null,this.childDomScaffolds=new List,this.detectors=new List,this.elementCreatedListener=null,this.detectors.add(new ElementDetector(this.namespaceUriMap)),this.detectors.add(new CdataDetector),this.detectors.add(new ClosingElementDetector(this.namespaceUriMap))}getElement(){return this.element}load(t,e,n){let i=new XmlCursor(t,e,null);this.loadDepth(1,i,n)}loadDepth(t,e,n){if(LOG$6.showPos(e.xml,e.cursor),LOG$6.debug(t,"Starting DomScaffold"),this.elementCreatedListener=n,e.eof())return LOG$6.debug(t,"Reached eof. Exiting"),!1;var i=null;if(this.detectors.forEach(function(n,r){return LOG$6.debug(t,"Starting "+n.getType()),n.detect(t+1,e),!n.isFound()||(i=n,!1)},this),null===i&&(e.cursor++,LOG$6.warn("WARN: No handler was found searching from position: "+e.cursor)),this.element=i.createElement(),i instanceof ElementDetector&&i.hasChildren()){let n=new Map;for(n.addAll(this.namespaceUriMap),this.element.getAttributes().forEach(function(t,e,i){"xmlns"===e.getNamespace()&&n.set(e.getName(),e.getValue())},this);!i.stop(t+1)&&e.cursor<e.xml.length;){let i=e.parentDomScaffold,r=new DomScaffold(n);e.parentDomScaffold=r,r.loadDepth(t+1,e,this.elementCreatedListener),this.childDomScaffolds.add(r),e.parentDomScaffold=i}}LOG$6.showPos(e.xml,e.cursor)}getTree(t){if(null===this.element)return null;let e=this.notifyElementCreatedListener(this.element,t);return this.childDomScaffolds.forEach(function(t,n){let i=t.getTree(e);return null!==i&&n.element.getChildElements().add(i),!0},this),this.element}notifyElementCreatedListener(t,e){return null!==this.elementCreatedListener&&void 0!==this.elementCreatedListener?this.elementCreatedListener.elementCreated(t,e):null}}class DomTree{constructor(t,e){this.elementCreatedListener=e,this.xml=t,this.rootElement=null}getRootElement(){return this.rootElement}setRootElement(t){this.rootElement=t}load(){let t=new DomScaffold(new Map);t.load(this.xml,0,this.elementCreatedListener),this.rootElement=t.getTree()}dump(){this.rootElement.dump()}read(){return this.rootElement.read()}}export{CdataDetector,ClosingElementDetector,DomScaffold,DomTree,ElementBody,ElementDetector,ReadAhead,XmlAttribute,XmlCdata,XmlCursor,XmlElement};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieG1scGFyc2VyX3YxLmpzIiwic291cmNlcyI6WyIuLi8uLi9zcmMveG1scGFyc2VyL3BhcnNlci94bWwvcGFyc2VyL3JlYWRBaGVhZC5qcyIsIi4uLy4uL3NyYy94bWxwYXJzZXIvcGFyc2VyL3htbC94bWxBdHRyaWJ1dGUuanMiLCIuLi8uLi9zcmMveG1scGFyc2VyL3BhcnNlci94bWwvcGFyc2VyL2RldGVjdG9ycy9lbGVtZW50Qm9keS5qcyIsIi4uLy4uL3NyYy94bWxwYXJzZXIvcGFyc2VyL3htbC94bWxDZGF0YS5qcyIsIi4uLy4uL3NyYy94bWxwYXJzZXIvcGFyc2VyL3htbC94bWxFbGVtZW50LmpzIiwiLi4vLi4vc3JjL3htbHBhcnNlci9wYXJzZXIveG1sL3BhcnNlci9kZXRlY3RvcnMvZWxlbWVudERldGVjdG9yLmpzIiwiLi4vLi4vc3JjL3htbHBhcnNlci9wYXJzZXIveG1sL3BhcnNlci9kZXRlY3RvcnMvY2RhdGFEZXRlY3Rvci5qcyIsIi4uLy4uL3NyYy94bWxwYXJzZXIvcGFyc2VyL3htbC9wYXJzZXIvZGV0ZWN0b3JzL2Nsb3NpbmdFbGVtZW50RGV0ZWN0b3IuanMiLCIuLi8uLi9zcmMveG1scGFyc2VyL3BhcnNlci94bWwvcGFyc2VyL3htbEN1cnNvci5qcyIsIi4uLy4uL3NyYy94bWxwYXJzZXIvcGFyc2VyL3htbC9wYXJzZXIvZG9tU2NhZmZvbGQuanMiLCIuLi8uLi9zcmMveG1scGFyc2VyL3BhcnNlci94bWwvZG9tVHJlZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5cbmV4cG9ydCBjbGFzcyBSZWFkQWhlYWR7XG5cbiAgICBzdGF0aWMgcmVhZCh2YWx1ZSwgbWF0Y2hlciwgY3Vyc29yLCBpZ25vcmVXaGl0ZXNwYWNlID0gZmFsc2Upe1xuICAgICAgICBsZXQgaW50ZXJuYWxDdXJzb3IgPSBjdXJzb3I7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBtYXRjaGVyLmxlbmd0aCAmJiBpIDwgdmFsdWUubGVuZ3RoIDsgaSsrKXtcbiAgICAgICAgICAgIHdoaWxlKGlnbm9yZVdoaXRlc3BhY2UgJiYgdmFsdWUuY2hhckF0KGludGVybmFsQ3Vyc29yKSA9PSAnICcpe1xuICAgICAgICAgICAgICAgIGludGVybmFsQ3Vyc29yKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih2YWx1ZS5jaGFyQXQoaW50ZXJuYWxDdXJzb3IpID09IG1hdGNoZXIuY2hhckF0KGkpKXtcbiAgICAgICAgICAgICAgICBpbnRlcm5hbEN1cnNvcisrO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGludGVybmFsQ3Vyc29yIC0gMTtcbiAgICB9XG59XG4iLCIvKiBqc2hpbnQgZXN2ZXJzaW9uOiA2ICovXG5cbmV4cG9ydCBjbGFzcyBYbWxBdHRyaWJ1dGUge1xuXG4gIGNvbnN0cnVjdG9yKG5hbWUsbmFtZXNwYWNlLHZhbHVlKSB7XG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgdGhpcy5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBnZXROYW1lKCl7XG4gICAgICByZXR1cm4gdGhpcy5uYW1lO1xuICB9XG5cbiAgc2V0TmFtZSh2YWwpe1xuICAgICAgdGhpcy5uYW1lID0gdmFsO1xuICB9XG5cbiAgZ2V0TmFtZXNwYWNlKCl7XG4gICAgcmV0dXJuIHRoaXMubmFtZXNwYWNlO1xuICB9XG5cbiAgc2V0TmFtZXNwYWNlKHZhbCl7XG4gICAgdGhpcy5uYW1lc3BhY2UgPSB2YWw7XG4gIH1cblxuICBnZXRWYWx1ZSgpe1xuICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBzZXRWYWx1ZSh2YWwpe1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbDtcbiAgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuXG5pbXBvcnQge0xvZ2dlciwgTWFwLCBTdHJpbmdVdGlsc30gZnJvbSBcImNvcmV1dGlsX3YxXCI7XG5pbXBvcnQge1JlYWRBaGVhZH0gZnJvbSBcIi4uL3JlYWRBaGVhZC5qc1wiO1xuaW1wb3J0IHtYbWxBdHRyaWJ1dGV9IGZyb20gXCIuLi8uLi94bWxBdHRyaWJ1dGUuanNcIjtcblxuY29uc3QgTE9HID0gbmV3IExvZ2dlcihcIkVsZW1lbnRCb2R5XCIpO1xuXG5leHBvcnQgY2xhc3MgRWxlbWVudEJvZHl7XG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgICB0aGlzLm5hbWUgPSBudWxsO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICBnZXROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xuICAgIH1cblxuICAgIGdldE5hbWVzcGFjZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZXNwYWNlO1xuICAgIH1cblxuICAgIGdldEF0dHJpYnV0ZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXM7XG4gICAgfVxuXG4gICAgZGV0ZWN0UG9zaXRpb25zKGRlcHRoLCB4bWwsIGN1cnNvcil7XG4gICAgICAgIGxldCBuYW1lU3RhcnRwb3MgPSBjdXJzb3I7XG4gICAgICAgIGxldCBuYW1lRW5kcG9zID0gbnVsbDtcbiAgICAgICAgd2hpbGUgKFN0cmluZ1V0aWxzLmlzSW5BbHBoYWJldCh4bWwuY2hhckF0KGN1cnNvcikpICYmIGN1cnNvciA8IHhtbC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGN1cnNvciArKztcbiAgICAgICAgfVxuICAgICAgICBpZih4bWwuY2hhckF0KGN1cnNvcikgPT0gJzonKXtcbiAgICAgICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0ZvdW5kIG5hbWVzcGFjZScpO1xuICAgICAgICAgICAgY3Vyc29yICsrO1xuICAgICAgICAgICAgd2hpbGUgKFN0cmluZ1V0aWxzLmlzSW5BbHBoYWJldCh4bWwuY2hhckF0KGN1cnNvcikpICYmIGN1cnNvciA8IHhtbC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmFtZUVuZHBvcyA9IGN1cnNvci0xO1xuICAgICAgICB0aGlzLm5hbWUgPSB4bWwuc3Vic3RyaW5nKG5hbWVTdGFydHBvcywgbmFtZUVuZHBvcysxKTtcbiAgICAgICAgaWYodGhpcy5uYW1lLmluZGV4T2YoXCI6XCIpID4gLTEpe1xuICAgICAgICAgICAgICAgIHRoaXMubmFtZXNwYWNlID0gdGhpcy5uYW1lLnNwbGl0KFwiOlwiKVswXTtcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSB0aGlzLm5hbWUuc3BsaXQoXCI6XCIpWzFdO1xuICAgICAgICB9XG4gICAgICAgIGN1cnNvciA9IHRoaXMuZGV0ZWN0QXR0cmlidXRlcyhkZXB0aCx4bWwsY3Vyc29yKTtcbiAgICAgICAgcmV0dXJuIGN1cnNvcjtcbiAgICB9XG5cbiAgICBkZXRlY3RBdHRyaWJ1dGVzKGRlcHRoLHhtbCxjdXJzb3Ipe1xuICAgICAgICBsZXQgZGV0ZWN0ZWRBdHRyTmFtZUN1cnNvciA9IG51bGw7XG4gICAgICAgIHdoaWxlKChkZXRlY3RlZEF0dHJOYW1lQ3Vyc29yID0gdGhpcy5kZXRlY3ROZXh0U3RhcnRBdHRyaWJ1dGUoZGVwdGgsIHhtbCwgY3Vyc29yKSkgIT0gLTEpe1xuICAgICAgICAgICAgY3Vyc29yID0gdGhpcy5kZXRlY3ROZXh0RW5kQXR0cmlidXRlKGRlcHRoLCB4bWwsIGRldGVjdGVkQXR0ck5hbWVDdXJzb3IpO1xuICAgICAgICAgICAgbGV0IG5hbWVzcGFjZSA9IG51bGw7XG4gICAgICAgICAgICBsZXQgbmFtZSA9IHhtbC5zdWJzdHJpbmcoZGV0ZWN0ZWRBdHRyTmFtZUN1cnNvcixjdXJzb3IrMSk7XG5cbiAgICAgICAgICAgIGlmKG5hbWUuaW5kZXhPZihcIjpcIikgPiAtMSl7XG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlID0gbmFtZS5zcGxpdChcIjpcIilbMF07XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3BsaXQoXCI6XCIpWzFdO1xuICAgICAgICAgICAgfSAgXG5cbiAgICAgICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0ZvdW5kIGF0dHJpYnV0ZSBmcm9tICcgKyBkZXRlY3RlZEF0dHJOYW1lQ3Vyc29yICsgJyAgdG8gJyArIGN1cnNvcik7XG4gICAgICAgICAgICBjdXJzb3IgPSB0aGlzLmRldGVjdFZhbHVlKG5hbWUsbmFtZXNwYWNlLGRlcHRoLCB4bWwsIGN1cnNvcisxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgIH1cblxuXG4gICAgZGV0ZWN0TmV4dFN0YXJ0QXR0cmlidXRlKGRlcHRoLCB4bWwsIGN1cnNvcil7XG4gICAgICAgIHdoaWxlKHhtbC5jaGFyQXQoY3Vyc29yKSA9PSAnICcgJiYgY3Vyc29yIDwgeG1sLmxlbmd0aCl7XG4gICAgICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgICAgICBpZihTdHJpbmdVdGlscy5pc0luQWxwaGFiZXQoeG1sLmNoYXJBdChjdXJzb3IpKSB8fCB4bWwuY2hhckF0KGN1cnNvcikgPT09IFwiLVwiKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICBkZXRlY3ROZXh0RW5kQXR0cmlidXRlKGRlcHRoLCB4bWwsIGN1cnNvcil7XG4gICAgICAgIHdoaWxlKFN0cmluZ1V0aWxzLmlzSW5BbHBoYWJldCh4bWwuY2hhckF0KGN1cnNvcikpIHx8IHhtbC5jaGFyQXQoY3Vyc29yKSA9PT0gXCItXCIpe1xuICAgICAgICAgICAgY3Vyc29yICsrO1xuICAgICAgICB9XG4gICAgICAgIGlmKHhtbC5jaGFyQXQoY3Vyc29yKSA9PSBcIjpcIil7XG4gICAgICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgICAgICB3aGlsZShTdHJpbmdVdGlscy5pc0luQWxwaGFiZXQoeG1sLmNoYXJBdChjdXJzb3IpKSB8fCB4bWwuY2hhckF0KGN1cnNvcikgPT09IFwiLVwiKXtcbiAgICAgICAgICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGN1cnNvciAtMTtcbiAgICB9XG5cbiAgICBkZXRlY3RWYWx1ZShuYW1lLCBuYW1lc3BhY2UsIGRlcHRoLCB4bWwsIGN1cnNvcil7XG4gICAgICAgIGxldCB2YWx1ZVBvcyA9IGN1cnNvcjtcbiAgICAgICAgbGV0IGZ1bGxuYW1lID0gbmFtZTtcbiAgICAgICAgaWYobmFtZXNwYWNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBmdWxsbmFtZSA9IG5hbWVzcGFjZSArIFwiOlwiICsgbmFtZTtcbiAgICAgICAgfVxuICAgICAgICBpZigodmFsdWVQb3MgPSBSZWFkQWhlYWQucmVhZCh4bWwsJz1cIicsdmFsdWVQb3MsdHJ1ZSkpID09IC0xKXtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zZXQoZnVsbG5hbWUsbmV3IFhtbEF0dHJpYnV0ZShuYW1lLG5hbWVzcGFjZSxudWxsKSk7XG4gICAgICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlUG9zKys7XG4gICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ1Bvc3NpYmxlIGF0dHJpYnV0ZSB2YWx1ZSBzdGFydCBhdCAnICsgdmFsdWVQb3MpO1xuICAgICAgICBsZXQgdmFsdWVTdGFydFBvcyA9IHZhbHVlUG9zO1xuICAgICAgICB3aGlsZSh0aGlzLmlzQXR0cmlidXRlQ29udGVudChkZXB0aCwgeG1sLCB2YWx1ZVBvcykpe1xuICAgICAgICAgICAgdmFsdWVQb3MrKztcbiAgICAgICAgfVxuICAgICAgICBpZih2YWx1ZVBvcyA9PSBjdXJzb3Ipe1xuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnNldChmdWxsbmFtZSwgbmV3IFhtbEF0dHJpYnV0ZShuYW1lLG5hbWVzcGFjZSwnJykpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zZXQoZnVsbG5hbWUsIG5ldyBYbWxBdHRyaWJ1dGUobmFtZSxuYW1lc3BhY2UseG1sLnN1YnN0cmluZyh2YWx1ZVN0YXJ0UG9zLHZhbHVlUG9zKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgTE9HLmRlYnVnKGRlcHRoLCAnRm91bmQgYXR0cmlidXRlIGNvbnRlbnQgZW5kaW5nIGF0ICcgKyAodmFsdWVQb3MtMSkpO1xuXG4gICAgICAgIGlmKCh2YWx1ZVBvcyA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnXCInLHZhbHVlUG9zLHRydWUpKSAhPSAtMSl7XG4gICAgICAgICAgICB2YWx1ZVBvcysrO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIExPRy5lcnJvcignTWlzc2luZyBlbmQgcXVvdGVzIG9uIGF0dHJpYnV0ZSBhdCBwb3NpdGlvbiAnICsgdmFsdWVQb3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZVBvcztcbiAgICB9XG5cblxuICAgIGlzQXR0cmlidXRlQ29udGVudChkZXB0aCwgeG1sLCBjdXJzb3Ipe1xuICAgICAgICBpZihSZWFkQWhlYWQucmVhZCh4bWwsJzwnLGN1cnNvcikgIT0gLTEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmKFJlYWRBaGVhZC5yZWFkKHhtbCwnPicsY3Vyc29yKSAhPSAtMSl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYoUmVhZEFoZWFkLnJlYWQoeG1sLCdcIicsY3Vyc29yKSAhPSAtMSl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuXG5pbXBvcnQge0xvZ2dlcn0gZnJvbSBcImNvcmV1dGlsX3YxXCJcblxuY29uc3QgTE9HID0gbmV3IExvZ2dlcihcIlhtbENkYXRhXCIpO1xuXG5leHBvcnQgY2xhc3MgWG1sQ2RhdGF7XG5cblx0Y29uc3RydWN0b3IodmFsdWUpe1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgc2V0VmFsdWUodmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldFZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgICB9XG5cbiAgICBkdW1wKCl7XG4gICAgICAgIHRoaXMuZHVtcExldmVsKDApO1xuICAgIH1cblxuICAgIGR1bXBMZXZlbChsZXZlbCl7XG4gICAgICAgIGxldCBzcGFjZXIgPSAnOic7XG4gICAgICAgIGZvcihsZXQgc3BhY2UgPSAwIDsgc3BhY2UgPCBsZXZlbCoyIDsgc3BhY2UgKyspe1xuICAgICAgICAgICAgc3BhY2VyID0gc3BhY2VyICsgJyAnO1xuICAgICAgICB9XG5cbiAgICAgICAgTE9HLmluZm8oc3BhY2VyICsgdGhpcy52YWx1ZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICByZWFkKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cblxuaW1wb3J0IHtMb2dnZXIsIExpc3QsIE1hcH0gZnJvbSBcImNvcmV1dGlsX3YxXCI7XG5pbXBvcnQge1htbENkYXRhfSBmcm9tIFwiLi94bWxDZGF0YS5qc1wiO1xuXG5jb25zdCBMT0cgPSBuZXcgTG9nZ2VyKFwiWG1sRWxlbWVudFwiKTtcblxuZXhwb3J0IGNsYXNzIFhtbEVsZW1lbnR7XG5cblx0Y29uc3RydWN0b3IobmFtZSwgbmFtZXNwYWNlLCBuYW1lc3BhY2VVcmksIHNlbGZDbG9zaW5nKXtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG4gICAgICAgIHRoaXMuc2VsZkNsb3NpbmcgPSBzZWxmQ2xvc2luZztcbiAgICAgICAgdGhpcy5jaGlsZEVsZW1lbnRzID0gbmV3IExpc3QoKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZVVyaSA9IG5hbWVzcGFjZVVyaTtcbiAgICB9XG5cbiAgICBnZXROYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xuICAgIH1cblxuICAgIGdldE5hbWVzcGFjZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZXNwYWNlO1xuICAgIH1cblxuICAgIGdldE5hbWVzcGFjZVVyaSgpe1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lc3BhY2VVcmk7XG4gICAgfVxuXG4gICAgZ2V0RnVsbE5hbWUoKSB7XG4gICAgICAgIGlmKHRoaXMubmFtZXNwYWNlID09PSBudWxsKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5uYW1lc3BhY2UgKyAnOicgKyB0aGlzLm5hbWU7XG4gICAgfVxuXG4gICAgZ2V0QXR0cmlidXRlcygpe1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzO1xuICAgIH1cblxuICAgIHNldEF0dHJpYnV0ZXMoYXR0cmlidXRlcyl7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXM7XG4gICAgfVxuXG4gICAgc2V0QXR0cmlidXRlKGtleSx2YWx1ZSkge1xuXHRcdHRoaXMuYXR0cmlidXRlcy5zZXQoa2V5LHZhbHVlKTtcblx0fVxuXG5cdGdldEF0dHJpYnV0ZShrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmdldChrZXkpO1xuXHR9XG5cbiAgICBjb250YWluc0F0dHJpYnV0ZShrZXkpe1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmNvbnRhaW5zKGtleSk7XG4gICAgfVxuXG5cdGNsZWFyQXR0cmlidXRlKCl7XG5cdFx0dGhpcy5hdHRyaWJ1dGVzID0gbmV3IE1hcCgpO1xuXHR9XG5cbiAgICBnZXRDaGlsZEVsZW1lbnRzKCl7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkRWxlbWVudHM7XG4gICAgfVxuXG4gICAgc2V0Q2hpbGRFbGVtZW50cyhlbGVtZW50cykge1xuICAgICAgICB0aGlzLmNoaWxkRWxlbWVudHMgPSBlbGVtZW50cztcbiAgICB9XG5cbiAgICBzZXRUZXh0KHRleHQpe1xuICAgICAgICB0aGlzLmNoaWxkRWxlbWVudHMgPSBuZXcgTGlzdCgpO1xuICAgICAgICB0aGlzLmFkZFRleHQodGV4dCk7XG4gICAgfVxuXG4gICAgYWRkVGV4dCh0ZXh0KXtcbiAgICAgICAgbGV0IHRleHRFbGVtZW50ID0gbmV3IFhtbENkYXRhKHRleHQpO1xuICAgICAgICB0aGlzLmNoaWxkRWxlbWVudHMuYWRkKHRleHRFbGVtZW50KTtcbiAgICB9XG5cbiAgICBkdW1wKCl7XG4gICAgICAgIHRoaXMuZHVtcExldmVsKDApO1xuICAgIH1cblxuICAgIGR1bXBMZXZlbChsZXZlbCl7XG4gICAgICAgIGxldCBzcGFjZXIgPSAnOic7XG4gICAgICAgIGZvcihsZXQgc3BhY2UgPSAwIDsgc3BhY2UgPCBsZXZlbCoyIDsgc3BhY2UgKyspe1xuICAgICAgICAgICAgc3BhY2VyID0gc3BhY2VyICsgJyAnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5zZWxmQ2xvc2luZyl7XG4gICAgICAgICAgICBMT0cuaW5mbyhzcGFjZXIgKyAnPCcgKyB0aGlzLmdldEZ1bGxOYW1lKCkgKyB0aGlzLnJlYWRBdHRyaWJ1dGVzKCkgKyAnLz4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBMT0cuaW5mbyhzcGFjZXIgKyAnPCcgKyB0aGlzLmdldEZ1bGxOYW1lKCkgKyB0aGlzLnJlYWRBdHRyaWJ1dGVzKCkgKyAnPicpO1xuICAgICAgICB0aGlzLmNoaWxkRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihjaGlsZEVsZW1lbnQpe1xuICAgICAgICAgICAgY2hpbGRFbGVtZW50LmR1bXBMZXZlbChsZXZlbCsxKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgTE9HLmluZm8oc3BhY2VyICsgJzwvJyArIHRoaXMuZ2V0RnVsbE5hbWUoKSArICc+Jyk7XG4gICAgfVxuXG4gICAgcmVhZCgpe1xuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XG4gICAgICAgIGlmKHRoaXMuc2VsZkNsb3Npbmcpe1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgJzwnICsgdGhpcy5nZXRGdWxsTmFtZSgpICsgdGhpcy5yZWFkQXR0cmlidXRlcygpICsgJy8+JztcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgJzwnICsgdGhpcy5nZXRGdWxsTmFtZSgpICsgdGhpcy5yZWFkQXR0cmlidXRlcygpICsgJz4nO1xuICAgICAgICB0aGlzLmNoaWxkRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihjaGlsZEVsZW1lbnQpe1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgY2hpbGRFbGVtZW50LnJlYWQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgJzwvJyArIHRoaXMuZ2V0RnVsbE5hbWUoKSArICc+JztcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZWFkQXR0cmlidXRlcygpe1xuICAgICAgICBsZXQgcmVzdWx0ID0gJyc7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksYXR0cmlidXRlLHBhcmVudCkge1xuICAgICAgICAgICAgbGV0IGZ1bGxuYW1lID0gYXR0cmlidXRlLmdldE5hbWUoKTtcbiAgICAgICAgICAgIGlmKGF0dHJpYnV0ZS5nZXROYW1lc3BhY2UoKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGZ1bGxuYW1lID0gYXR0cmlidXRlLmdldE5hbWVzcGFjZSgpICsgXCI6XCIgKyBhdHRyaWJ1dGUuZ2V0TmFtZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgJyAnICsgZnVsbG5hbWU7XG4gICAgICAgICAgICBpZihhdHRyaWJ1dGUuZ2V0VmFsdWUoKSAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgJz1cIicgKyBhdHRyaWJ1dGUuZ2V0VmFsdWUoKSArICdcIic7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LHRoaXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cblxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gXCJjb3JldXRpbF92MVwiO1xuaW1wb3J0IHtSZWFkQWhlYWR9IGZyb20gXCIuLi9yZWFkQWhlYWQuanNcIjtcbmltcG9ydCB7RWxlbWVudEJvZHl9IGZyb20gXCIuL2VsZW1lbnRCb2R5LmpzXCI7XG5pbXBvcnQge1htbEVsZW1lbnR9IGZyb20gXCIuLi8uLi94bWxFbGVtZW50LmpzXCI7XG5cbmNvbnN0IExPRyA9IG5ldyBMb2dnZXIoXCJFbGVtZW50RGV0ZWN0b3JcIik7XG5cbmV4cG9ydCBjbGFzcyBFbGVtZW50RGV0ZWN0b3J7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lc3BhY2VVcmlNYXApe1xuICAgICAgICB0aGlzLnR5cGUgPSAnRWxlbWVudERldGVjdG9yJztcbiAgICAgICAgdGhpcy5uYW1lc3BhY2VVcmlNYXAgPSBuYW1lc3BhY2VVcmlNYXA7XG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mb3VuZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnhtbEN1cnNvciA9IG51bGw7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlRWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcbiAgICB9XG5cbiAgICBnZXRUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlO1xuICAgIH1cblxuICAgIGlzRm91bmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvdW5kO1xuICAgIH1cblxuICAgIGhhc0NoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbjtcbiAgICB9XG5cbiAgICBkZXRlY3QoZGVwdGgsIHhtbEN1cnNvcil7XG4gICAgICAgIHRoaXMueG1sQ3Vyc29yID0geG1sQ3Vyc29yO1xuICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdMb29raW5nIGZvciBvcGVuaW5nIGVsZW1lbnQgYXQgcG9zaXRpb24gJyArIHhtbEN1cnNvci5jdXJzb3IpO1xuICAgICAgICBsZXQgZWxlbWVudEJvZHkgPSBuZXcgRWxlbWVudEJvZHkoKTtcbiAgICAgICAgbGV0IGVuZHBvcyA9IEVsZW1lbnREZXRlY3Rvci5kZXRlY3RPcGVuRWxlbWVudChkZXB0aCwgeG1sQ3Vyc29yLnhtbCwgeG1sQ3Vyc29yLmN1cnNvcixlbGVtZW50Qm9keSk7XG4gICAgICAgIGlmKGVuZHBvcyAhPSAtMSkge1xuXG4gICAgICAgICAgICBsZXQgbmFtZXNwYWNlVXJpID0gbnVsbDtcbiAgICAgICAgICAgIGlmKGVsZW1lbnRCb2R5LmdldE5hbWVzcGFjZSgpICE9PSBudWxsICYmIGVsZW1lbnRCb2R5LmdldE5hbWVzcGFjZSgpICE9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIG5hbWVzcGFjZVVyaSA9IHRoaXMubmFtZXNwYWNlVXJpTWFwLmdldChlbGVtZW50Qm9keS5nZXROYW1lc3BhY2UoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG5ldyBYbWxFbGVtZW50KGVsZW1lbnRCb2R5LmdldE5hbWUoKSwgZWxlbWVudEJvZHkuZ2V0TmFtZXNwYWNlKCksIG5hbWVzcGFjZVVyaSwgZmFsc2UpO1xuXG4gICAgICAgICAgICBlbGVtZW50Qm9keS5nZXRBdHRyaWJ1dGVzKCkuZm9yRWFjaChmdW5jdGlvbihhdHRyaWJ1dGVOYW1lLGF0dHJpYnV0ZVZhbHVlLHBhcmVudCl7XG4gICAgICAgICAgICAgICAgcGFyZW50LmVsZW1lbnQuZ2V0QXR0cmlidXRlcygpLnNldChhdHRyaWJ1dGVOYW1lLGF0dHJpYnV0ZVZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sdGhpcyk7XG5cbiAgICAgICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0ZvdW5kIG9wZW5pbmcgdGFnIDwnICsgdGhpcy5lbGVtZW50LmdldEZ1bGxOYW1lKCkgKyAnPiBmcm9tICcgKyAgeG1sQ3Vyc29yLmN1cnNvciAgKyAnIHRvICcgKyBlbmRwb3MpO1xuICAgICAgICAgICAgeG1sQ3Vyc29yLmN1cnNvciA9IGVuZHBvcyArIDE7XG5cbiAgICAgICAgICAgIGlmKCF0aGlzLnN0b3AoZGVwdGgpKXtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZm91bmQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RvcChkZXB0aCl7XG4gICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0xvb2tpbmcgZm9yIGNsb3NpbmcgZWxlbWVudCBhdCBwb3NpdGlvbiAnICsgdGhpcy54bWxDdXJzb3IuY3Vyc29yKTtcbiAgICAgICAgbGV0IGNsb3NpbmdFbGVtZW50ID0gRWxlbWVudERldGVjdG9yLmRldGVjdEVuZEVsZW1lbnQoZGVwdGgsIHRoaXMueG1sQ3Vyc29yLnhtbCwgdGhpcy54bWxDdXJzb3IuY3Vyc29yKTtcbiAgICAgICAgaWYoY2xvc2luZ0VsZW1lbnQgIT0gLTEpe1xuICAgICAgICAgICAgbGV0IGNsb3NpbmdUYWdOYW1lID0gIHRoaXMueG1sQ3Vyc29yLnhtbC5zdWJzdHJpbmcodGhpcy54bWxDdXJzb3IuY3Vyc29yKzIsY2xvc2luZ0VsZW1lbnQpO1xuICAgICAgICAgICAgTE9HLmRlYnVnKGRlcHRoLCAnRm91bmQgY2xvc2luZyB0YWcgPC8nICsgY2xvc2luZ1RhZ05hbWUgKyAnPiBmcm9tICcgKyAgdGhpcy54bWxDdXJzb3IuY3Vyc29yICArICcgdG8gJyArIGNsb3NpbmdFbGVtZW50KTtcblxuICAgICAgICAgICAgaWYodGhpcy5lbGVtZW50LmdldEZ1bGxOYW1lKCkgIT0gY2xvc2luZ1RhZ05hbWUpe1xuICAgICAgICAgICAgICAgIExPRy5lcnJvcignRVJSOiBNaXNtYXRjaCBiZXR3ZWVuIG9wZW5pbmcgdGFnIDwnICsgdGhpcy5lbGVtZW50LmdldEZ1bGxOYW1lKCkgKyAnPiBhbmQgY2xvc2luZyB0YWcgPC8nICsgY2xvc2luZ1RhZ05hbWUgKyAnPiBXaGVuIGV4aXRpbmcgdG8gcGFyZW50IGVsZW1udCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy54bWxDdXJzb3IuY3Vyc29yID0gY2xvc2luZ0VsZW1lbnQgKzE7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc3RhdGljIGRldGVjdE9wZW5FbGVtZW50KGRlcHRoLCB4bWwsIGN1cnNvciwgZWxlbWVudEJvZHkpIHtcbiAgICAgICAgaWYoKGN1cnNvciA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnPCcsY3Vyc29yKSkgPT0gLTEpe1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGN1cnNvciArKztcbiAgICAgICAgY3Vyc29yID0gZWxlbWVudEJvZHkuZGV0ZWN0UG9zaXRpb25zKGRlcHRoKzEsIHhtbCwgY3Vyc29yKTtcbiAgICAgICAgaWYoKGN1cnNvciA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnPicsY3Vyc29yLCB0cnVlKSkgPT0gLTEpe1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJzb3I7XG4gICAgfVxuXG4gICAgc3RhdGljIGRldGVjdEVuZEVsZW1lbnQoZGVwdGgsIHhtbCwgY3Vyc29yKXtcbiAgICAgICAgaWYoKGN1cnNvciA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnPC8nLGN1cnNvcikpID09IC0xKXtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgIGN1cnNvciA9IG5ldyBFbGVtZW50Qm9keSgpLmRldGVjdFBvc2l0aW9ucyhkZXB0aCsxLCB4bWwsIGN1cnNvcik7XG4gICAgICAgIGlmKChjdXJzb3IgPSBSZWFkQWhlYWQucmVhZCh4bWwsJz4nLGN1cnNvciwgdHJ1ZSkpID09IC0xKXtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgIH1cblxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuaW1wb3J0IHtMb2dnZXJ9IGZyb20gXCJjb3JldXRpbF92MVwiO1xuaW1wb3J0IHtYbWxDZGF0YX0gZnJvbSBcIi4uLy4uL3htbENkYXRhLmpzXCI7XG5pbXBvcnQge1JlYWRBaGVhZH0gZnJvbSBcIi4uL3JlYWRBaGVhZC5qc1wiO1xuXG5jb25zdCBMT0cgPSBuZXcgTG9nZ2VyKFwiQ2RhdGFEZXRlY3RvclwiKTtcblxuZXhwb3J0IGNsYXNzIENkYXRhRGV0ZWN0b3J7XG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgICB0aGlzLnR5cGUgPSAnQ2RhdGFEZXRlY3Rvcic7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmZvdW5kID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaXNGb3VuZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm91bmQ7XG4gICAgfVxuXG4gICAgZ2V0VHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZTtcbiAgICB9XG5cbiAgICBjcmVhdGVFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IFhtbENkYXRhKHRoaXMudmFsdWUpO1xuICAgIH1cblxuICAgIGRldGVjdChkZXB0aCwgeG1sQ3Vyc29yKXtcbiAgICAgICAgdGhpcy5mb3VuZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcblxuICAgICAgICBsZXQgZW5kUG9zID0gdGhpcy5kZXRlY3RDb250ZW50KGRlcHRoLCB4bWxDdXJzb3IueG1sLCB4bWxDdXJzb3IuY3Vyc29yLCB4bWxDdXJzb3IucGFyZW50RG9tU2NhZmZvbGQpO1xuICAgICAgICBpZihlbmRQb3MgIT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5oYXNDaGlsZHJlbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHhtbEN1cnNvci54bWwuc3Vic3RyaW5nKHhtbEN1cnNvci5jdXJzb3IsZW5kUG9zKTtcbiAgICAgICAgICAgIHhtbEN1cnNvci5jdXJzb3IgPSBlbmRQb3M7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXRlY3RDb250ZW50KGRlcHRoLCB4bWwsIGN1cnNvciwgcGFyZW50RG9tU2NhZmZvbGQpIHtcbiAgICAgICAgTE9HLmRlYnVnKGRlcHRoLCAnQ2RhdGEgc3RhcnQgYXQgJyArIGN1cnNvcik7XG4gICAgICAgIGxldCBpbnRlcm5hbFN0YXJ0UG9zID0gY3Vyc29yO1xuICAgICAgICBpZighQ2RhdGFEZXRlY3Rvci5pc0NvbnRlbnQoZGVwdGgsIHhtbCwgY3Vyc29yKSl7XG4gICAgICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdObyBDZGF0YSBmb3VuZCcpO1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlKENkYXRhRGV0ZWN0b3IuaXNDb250ZW50KGRlcHRoLCB4bWwsIGN1cnNvcikgJiYgY3Vyc29yIDwgeG1sLmxlbmd0aCl7XG4gICAgICAgICAgICBjdXJzb3IgKys7XG4gICAgICAgIH1cbiAgICAgICAgTE9HLmRlYnVnKGRlcHRoLCAnQ2RhdGEgZW5kIGF0ICcgKyAoY3Vyc29yLTEpKTtcbiAgICAgICAgaWYocGFyZW50RG9tU2NhZmZvbGQgPT09IG51bGwpe1xuICAgICAgICAgICAgTE9HLmVycm9yKCdFUlI6IENvbnRlbnQgbm90IGFsbG93ZWQgb24gcm9vdCBsZXZlbCBpbiB4bWwgZG9jdW1lbnQnKTtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdDZGF0YSBmb3VuZCB2YWx1ZSBpcyAnICsgeG1sLnN1YnN0cmluZyhpbnRlcm5hbFN0YXJ0UG9zLGN1cnNvcikpO1xuICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgIH1cblxuICAgIHN0YXRpYyBpc0NvbnRlbnQoZGVwdGgsIHhtbCwgY3Vyc29yKXtcbiAgICAgICAgaWYoUmVhZEFoZWFkLnJlYWQoeG1sLCc8JyxjdXJzb3IpICE9IC0xKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZihSZWFkQWhlYWQucmVhZCh4bWwsJz4nLGN1cnNvcikgIT0gLTEpe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cblxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gXCJjb3JldXRpbF92MVwiO1xuaW1wb3J0IHtYbWxFbGVtZW50fSBmcm9tIFwiLi4vLi4veG1sRWxlbWVudC5qc1wiO1xuaW1wb3J0IHtSZWFkQWhlYWR9IGZyb20gXCIuLi9yZWFkQWhlYWQuanNcIjtcbmltcG9ydCB7RWxlbWVudEJvZHl9IGZyb20gXCIuL2VsZW1lbnRCb2R5LmpzXCI7XG5pbXBvcnQge1htbEF0dHJpYnV0ZX0gZnJvbSBcIi4uLy4uL3htbEF0dHJpYnV0ZS5qc1wiO1xuXG5jb25zdCBMT0cgPSBuZXcgTG9nZ2VyKFwiQ2xvc2luZ0VsZW1lbnREZXRlY3RvclwiKTtcblxuZXhwb3J0IGNsYXNzIENsb3NpbmdFbGVtZW50RGV0ZWN0b3J7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lc3BhY2VVcmlNYXApe1xuICAgICAgICB0aGlzLnR5cGUgPSAnQ2xvc2luZ0VsZW1lbnREZXRlY3Rvcic7XG4gICAgICAgIHRoaXMubmFtZXNwYWNlVXJpTWFwID0gbmFtZXNwYWNlVXJpTWFwO1xuICAgICAgICB0aGlzLmZvdW5kID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlRWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcbiAgICB9XG5cbiAgICBnZXRUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50eXBlO1xuICAgIH1cblxuICAgIGlzRm91bmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvdW5kO1xuICAgIH1cblxuICAgIGRldGVjdChkZXB0aCwgeG1sQ3Vyc29yKSB7XG4gICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0xvb2tpbmcgZm9yIHNlbGYgY2xvc2luZyBlbGVtZW50IGF0IHBvc2l0aW9uICcgKyB4bWxDdXJzb3IuY3Vyc29yKTtcbiAgICAgICAgbGV0IGVsZW1lbnRCb2R5ID0gbmV3IEVsZW1lbnRCb2R5KCk7XG4gICAgICAgIGxldCBlbmRwb3MgPSBDbG9zaW5nRWxlbWVudERldGVjdG9yLmRldGVjdENsb3NpbmdFbGVtZW50KGRlcHRoLCB4bWxDdXJzb3IueG1sLCB4bWxDdXJzb3IuY3Vyc29yLGVsZW1lbnRCb2R5KTtcbiAgICAgICAgaWYoZW5kcG9zICE9IC0xKXtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG5ldyBYbWxFbGVtZW50KGVsZW1lbnRCb2R5LmdldE5hbWUoKSwgZWxlbWVudEJvZHkuZ2V0TmFtZXNwYWNlKCksIHRoaXMubmFtZXNwYWNlVXJpTWFwLCB0cnVlKTtcblxuICAgICAgICAgICAgZWxlbWVudEJvZHkuZ2V0QXR0cmlidXRlcygpLmZvckVhY2goZnVuY3Rpb24oYXR0cmlidXRlTmFtZSxhdHRyaWJ1dGVWYWx1ZSxwYXJlbnQpe1xuICAgICAgICAgICAgICAgIHBhcmVudC5lbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lLGF0dHJpYnV0ZVZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sdGhpcyk7XG5cbiAgICAgICAgICAgIExPRy5kZWJ1ZyhkZXB0aCwgJ0ZvdW5kIHNlbGYgY2xvc2luZyB0YWcgPCcgKyB0aGlzLmVsZW1lbnQuZ2V0RnVsbE5hbWUoKSArICcvPiBmcm9tICcgKyAgeG1sQ3Vyc29yLmN1cnNvciAgKyAnIHRvICcgKyBlbmRwb3MpO1xuICAgICAgICAgICAgdGhpcy5mb3VuZCA9IHRydWU7XG4gICAgICAgICAgICB4bWxDdXJzb3IuY3Vyc29yID0gZW5kcG9zICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0YXRpYyBkZXRlY3RDbG9zaW5nRWxlbWVudChkZXB0aCwgeG1sLCBjdXJzb3IsIGVsZW1lbnRCb2R5KXtcbiAgICAgICAgaWYoKGN1cnNvciA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnPCcsY3Vyc29yKSkgPT0gLTEpe1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIGN1cnNvciArKztcbiAgICAgICAgY3Vyc29yID0gZWxlbWVudEJvZHkuZGV0ZWN0UG9zaXRpb25zKGRlcHRoKzEsIHhtbCwgY3Vyc29yKTtcbiAgICAgICAgaWYoKGN1cnNvciA9IFJlYWRBaGVhZC5yZWFkKHhtbCwnLz4nLGN1cnNvcikpID09IC0xKXtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3Vyc29yO1xuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cblxuZXhwb3J0IGNsYXNzIFhtbEN1cnNvcntcblxuICAgIGNvbnN0cnVjdG9yKHhtbCwgY3Vyc29yLCBwYXJlbnREb21TY2FmZm9sZCl7XG4gICAgICAgIHRoaXMueG1sID0geG1sO1xuICAgICAgICB0aGlzLmN1cnNvciA9IGN1cnNvcjtcbiAgICAgICAgdGhpcy5wYXJlbnREb21TY2FmZm9sZCA9IHBhcmVudERvbVNjYWZmb2xkO1xuICAgIH1cblxuICAgIGVvZigpe1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJzb3IgPj0gdGhpcy54bWwubGVuZ3RoO1xuICAgIH1cbn1cbiIsIi8qIGpzaGludCBlc3ZlcnNpb246IDYgKi9cblxuaW1wb3J0IHtMb2dnZXIsIE1hcCwgTGlzdH0gZnJvbSBcImNvcmV1dGlsX3YxXCI7XG5pbXBvcnQge0VsZW1lbnREZXRlY3Rvcn0gZnJvbSBcIi4vZGV0ZWN0b3JzL2VsZW1lbnREZXRlY3Rvci5qc1wiO1xuaW1wb3J0IHtDZGF0YURldGVjdG9yfSBmcm9tIFwiLi9kZXRlY3RvcnMvY2RhdGFEZXRlY3Rvci5qc1wiO1xuaW1wb3J0IHtDbG9zaW5nRWxlbWVudERldGVjdG9yfSBmcm9tIFwiLi9kZXRlY3RvcnMvY2xvc2luZ0VsZW1lbnREZXRlY3Rvci5qc1wiO1xuaW1wb3J0IHtYbWxDdXJzb3J9IGZyb20gXCIuL3htbEN1cnNvci5qc1wiO1xuXG5jb25zdCBMT0cgPSBuZXcgTG9nZ2VyKFwiRG9tU2NhZmZvbGRcIik7XG5cbmV4cG9ydCBjbGFzcyBEb21TY2FmZm9sZHtcblxuICAgIGNvbnN0cnVjdG9yKG5hbWVzcGFjZVVyaU1hcCl7XG4gICAgICAgIHRoaXMubmFtZXNwYWNlVXJpTWFwID0gbmFtZXNwYWNlVXJpTWFwO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xuICAgICAgICB0aGlzLmNoaWxkRG9tU2NhZmZvbGRzID0gbmV3IExpc3QoKTtcbiAgICAgICAgdGhpcy5kZXRlY3RvcnMgPSBuZXcgTGlzdCgpO1xuICAgICAgICB0aGlzLmVsZW1lbnRDcmVhdGVkTGlzdGVuZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmRldGVjdG9ycy5hZGQobmV3IEVsZW1lbnREZXRlY3Rvcih0aGlzLm5hbWVzcGFjZVVyaU1hcCkpO1xuICAgICAgICB0aGlzLmRldGVjdG9ycy5hZGQobmV3IENkYXRhRGV0ZWN0b3IoKSk7XG4gICAgICAgIHRoaXMuZGV0ZWN0b3JzLmFkZChuZXcgQ2xvc2luZ0VsZW1lbnREZXRlY3Rvcih0aGlzLm5hbWVzcGFjZVVyaU1hcCkpO1xuICAgIH1cblxuICAgIGdldEVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XG4gICAgfVxuXG4gICAgbG9hZCh4bWwsIGN1cnNvciwgZWxlbWVudENyZWF0ZWRMaXN0ZW5lcil7XG4gICAgICAgIGxldCB4bWxDdXJzb3IgPSBuZXcgWG1sQ3Vyc29yKHhtbCwgY3Vyc29yLCBudWxsKTtcbiAgICAgICAgdGhpcy5sb2FkRGVwdGgoMSwgeG1sQ3Vyc29yLCBlbGVtZW50Q3JlYXRlZExpc3RlbmVyKTtcbiAgICB9XG5cbiAgICBsb2FkRGVwdGgoZGVwdGgsIHhtbEN1cnNvciwgZWxlbWVudENyZWF0ZWRMaXN0ZW5lcil7XG4gICAgICAgIExPRy5zaG93UG9zKHhtbEN1cnNvci54bWwsIHhtbEN1cnNvci5jdXJzb3IpO1xuICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdTdGFydGluZyBEb21TY2FmZm9sZCcpO1xuICAgICAgICB0aGlzLmVsZW1lbnRDcmVhdGVkTGlzdGVuZXIgPSBlbGVtZW50Q3JlYXRlZExpc3RlbmVyO1xuXG4gICAgICAgIGlmKHhtbEN1cnNvci5lb2YoKSl7XG4gICAgICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdSZWFjaGVkIGVvZi4gRXhpdGluZycpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVsZW1lbnREZXRlY3RvciA9IG51bGw7XG4gICAgICAgIHRoaXMuZGV0ZWN0b3JzLmZvckVhY2goZnVuY3Rpb24oY3VyRWxlbWVudERldGVjdG9yLHBhcmVudCl7XG4gICAgICAgICAgICBMT0cuZGVidWcoZGVwdGgsICdTdGFydGluZyAnICsgY3VyRWxlbWVudERldGVjdG9yLmdldFR5cGUoKSk7XG4gICAgICAgICAgICBjdXJFbGVtZW50RGV0ZWN0b3IuZGV0ZWN0KGRlcHRoICsgMSx4bWxDdXJzb3IpO1xuICAgICAgICAgICAgaWYoIWN1ckVsZW1lbnREZXRlY3Rvci5pc0ZvdW5kKCkpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxlbWVudERldGVjdG9yID0gY3VyRWxlbWVudERldGVjdG9yO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LHRoaXMpO1xuXG4gICAgICAgIGlmKGVsZW1lbnREZXRlY3RvciA9PT0gbnVsbCl7XG4gICAgICAgICAgICB4bWxDdXJzb3IuY3Vyc29yKys7XG4gICAgICAgICAgICBMT0cud2FybignV0FSTjogTm8gaGFuZGxlciB3YXMgZm91bmQgc2VhcmNoaW5nIGZyb20gcG9zaXRpb246ICcgKyB4bWxDdXJzb3IuY3Vyc29yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnREZXRlY3Rvci5jcmVhdGVFbGVtZW50KCk7XG5cbiAgICAgICAgaWYoZWxlbWVudERldGVjdG9yIGluc3RhbmNlb2YgRWxlbWVudERldGVjdG9yICYmIGVsZW1lbnREZXRlY3Rvci5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICBsZXQgbmFtZXNwYWNlVXJpTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgbmFtZXNwYWNlVXJpTWFwLmFkZEFsbCh0aGlzLm5hbWVzcGFjZVVyaU1hcCk7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlcygpLmZvckVhY2goZnVuY3Rpb24obmFtZSxjdXJBdHRyaWJ1dGUscGFyZW50KXtcbiAgICAgICAgICAgICAgICBpZihcInhtbG5zXCIgPT09IGN1ckF0dHJpYnV0ZS5nZXROYW1lc3BhY2UoKSl7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZVVyaU1hcC5zZXQoY3VyQXR0cmlidXRlLmdldE5hbWUoKSxjdXJBdHRyaWJ1dGUuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgIHdoaWxlKCFlbGVtZW50RGV0ZWN0b3Iuc3RvcChkZXB0aCArIDEpICYmIHhtbEN1cnNvci5jdXJzb3IgPCB4bWxDdXJzb3IueG1sLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgbGV0IHByZXZpb3VzUGFyZW50U2NhZmZvbGQgPSB4bWxDdXJzb3IucGFyZW50RG9tU2NhZmZvbGQ7XG4gICAgICAgICAgICAgICAgbGV0IGNoaWxkU2NhZmZvbGQgPSBuZXcgRG9tU2NhZmZvbGQobmFtZXNwYWNlVXJpTWFwKTtcbiAgICAgICAgICAgICAgICB4bWxDdXJzb3IucGFyZW50RG9tU2NhZmZvbGQgPSBjaGlsZFNjYWZmb2xkO1xuICAgICAgICAgICAgICAgIGNoaWxkU2NhZmZvbGQubG9hZERlcHRoKGRlcHRoKzEsIHhtbEN1cnNvciwgdGhpcy5lbGVtZW50Q3JlYXRlZExpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkRG9tU2NhZmZvbGRzLmFkZChjaGlsZFNjYWZmb2xkKTtcbiAgICAgICAgICAgICAgICB4bWxDdXJzb3IucGFyZW50RG9tU2NhZmZvbGQgPSBwcmV2aW91c1BhcmVudFNjYWZmb2xkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIExPRy5zaG93UG9zKHhtbEN1cnNvci54bWwsIHhtbEN1cnNvci5jdXJzb3IpO1xuICAgIH1cblxuICAgIGdldFRyZWUocGFyZW50Tm90aWZ5UmVzdWx0KXtcbiAgICAgICAgaWYodGhpcy5lbGVtZW50ID09PSBudWxsKXtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5vdGlmeVJlc3VsdCA9IHRoaXMubm90aWZ5RWxlbWVudENyZWF0ZWRMaXN0ZW5lcih0aGlzLmVsZW1lbnQscGFyZW50Tm90aWZ5UmVzdWx0KTtcblxuICAgICAgICB0aGlzLmNoaWxkRG9tU2NhZmZvbGRzLmZvckVhY2goZnVuY3Rpb24oY2hpbGREb21TY2FmZm9sZCxwYXJlbnQpIHtcbiAgICAgICAgICAgIGxldCBjaGlsZEVsZW1lbnQgPSBjaGlsZERvbVNjYWZmb2xkLmdldFRyZWUobm90aWZ5UmVzdWx0KTtcbiAgICAgICAgICAgIGlmKGNoaWxkRWxlbWVudCAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgcGFyZW50LmVsZW1lbnQuZ2V0Q2hpbGRFbGVtZW50cygpLmFkZChjaGlsZEVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sdGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcbiAgICB9XG5cbiAgICBub3RpZnlFbGVtZW50Q3JlYXRlZExpc3RlbmVyKGVsZW1lbnQsIHBhcmVudE5vdGlmeVJlc3VsdCkge1xuICAgICAgICBpZih0aGlzLmVsZW1lbnRDcmVhdGVkTGlzdGVuZXIgIT09IG51bGwgJiYgdGhpcy5lbGVtZW50Q3JlYXRlZExpc3RlbmVyICE9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudENyZWF0ZWRMaXN0ZW5lci5lbGVtZW50Q3JlYXRlZChlbGVtZW50LCBwYXJlbnROb3RpZnlSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxufVxuIiwiLyoganNoaW50IGVzdmVyc2lvbjogNiAqL1xuXG5pbXBvcnQge0RvbVNjYWZmb2xkfSBmcm9tIFwiLi9wYXJzZXIvZG9tU2NhZmZvbGQuanNcIjtcbmltcG9ydCB7TWFwfSBmcm9tIFwiY29yZXV0aWxfdjFcIjtcblxuZXhwb3J0IGNsYXNzIERvbVRyZWV7XG5cbiAgICBjb25zdHJ1Y3Rvcih4bWwsIGVsZW1lbnRDcmVhdGVkTGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50Q3JlYXRlZExpc3RlbmVyID0gZWxlbWVudENyZWF0ZWRMaXN0ZW5lcjtcbiAgICAgICAgdGhpcy54bWwgPSB4bWw7XG4gICAgICAgIHRoaXMucm9vdEVsZW1lbnQgPSBudWxsO1xuICAgIH1cblxuICAgIGdldFJvb3RFbGVtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290RWxlbWVudDtcbiAgICB9XG5cbiAgICBzZXRSb290RWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHRoaXMucm9vdEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cblxuICAgIGxvYWQoKXtcbiAgICAgICAgbGV0IGRvbVNjYWZmb2xkID0gbmV3IERvbVNjYWZmb2xkKG5ldyBNYXAoKSk7XG4gICAgICAgIGRvbVNjYWZmb2xkLmxvYWQodGhpcy54bWwsMCx0aGlzLmVsZW1lbnRDcmVhdGVkTGlzdGVuZXIpO1xuICAgICAgICB0aGlzLnJvb3RFbGVtZW50ID0gZG9tU2NhZmZvbGQuZ2V0VHJlZSgpO1xuICAgIH1cblxuICAgIGR1bXAoKXtcbiAgICAgICAgdGhpcy5yb290RWxlbWVudC5kdW1wKCk7XG4gICAgfVxuXG4gICAgcmVhZCgpe1xuICAgICAgICByZXR1cm4gdGhpcy5yb290RWxlbWVudC5yZWFkKCk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbIlJlYWRBaGVhZCIsIltvYmplY3QgT2JqZWN0XSIsInZhbHVlIiwibWF0Y2hlciIsImN1cnNvciIsImlnbm9yZVdoaXRlc3BhY2UiLCJpbnRlcm5hbEN1cnNvciIsImkiLCJsZW5ndGgiLCJjaGFyQXQiLCJYbWxBdHRyaWJ1dGUiLCJuYW1lIiwibmFtZXNwYWNlIiwidGhpcyIsInZhbCIsIkxPRyIsIkxvZ2dlciIsIkVsZW1lbnRCb2R5IiwiYXR0cmlidXRlcyIsIk1hcCIsImRlcHRoIiwieG1sIiwibmFtZVN0YXJ0cG9zIiwibmFtZUVuZHBvcyIsIlN0cmluZ1V0aWxzIiwiaXNJbkFscGhhYmV0IiwiZGVidWciLCJzdWJzdHJpbmciLCJpbmRleE9mIiwic3BsaXQiLCJkZXRlY3RBdHRyaWJ1dGVzIiwiZGV0ZWN0ZWRBdHRyTmFtZUN1cnNvciIsImRldGVjdE5leHRTdGFydEF0dHJpYnV0ZSIsImRldGVjdE5leHRFbmRBdHRyaWJ1dGUiLCJkZXRlY3RWYWx1ZSIsInZhbHVlUG9zIiwiZnVsbG5hbWUiLCJyZWFkIiwic2V0IiwidmFsdWVTdGFydFBvcyIsImlzQXR0cmlidXRlQ29udGVudCIsImVycm9yIiwiWG1sQ2RhdGEiLCJkdW1wTGV2ZWwiLCJsZXZlbCIsInNwYWNlciIsInNwYWNlIiwiaW5mbyIsIlhtbEVsZW1lbnQiLCJuYW1lc3BhY2VVcmkiLCJzZWxmQ2xvc2luZyIsImNoaWxkRWxlbWVudHMiLCJMaXN0Iiwia2V5IiwiZ2V0IiwiY29udGFpbnMiLCJlbGVtZW50cyIsInRleHQiLCJhZGRUZXh0IiwidGV4dEVsZW1lbnQiLCJhZGQiLCJnZXRGdWxsTmFtZSIsInJlYWRBdHRyaWJ1dGVzIiwiZm9yRWFjaCIsImNoaWxkRWxlbWVudCIsInJlc3VsdCIsImF0dHJpYnV0ZSIsInBhcmVudCIsImdldE5hbWUiLCJnZXROYW1lc3BhY2UiLCJnZXRWYWx1ZSIsIkVsZW1lbnREZXRlY3RvciIsIm5hbWVzcGFjZVVyaU1hcCIsInR5cGUiLCJjaGlsZHJlbiIsImZvdW5kIiwieG1sQ3Vyc29yIiwiZWxlbWVudCIsImVsZW1lbnRCb2R5IiwiZW5kcG9zIiwiZGV0ZWN0T3BlbkVsZW1lbnQiLCJ1bmRlZmluZWQiLCJnZXRBdHRyaWJ1dGVzIiwiYXR0cmlidXRlTmFtZSIsImF0dHJpYnV0ZVZhbHVlIiwic3RvcCIsImNsb3NpbmdFbGVtZW50IiwiZGV0ZWN0RW5kRWxlbWVudCIsImNsb3NpbmdUYWdOYW1lIiwiZGV0ZWN0UG9zaXRpb25zIiwiQ2RhdGFEZXRlY3RvciIsImVuZFBvcyIsImRldGVjdENvbnRlbnQiLCJwYXJlbnREb21TY2FmZm9sZCIsImhhc0NoaWxkcmVuIiwiaW50ZXJuYWxTdGFydFBvcyIsImlzQ29udGVudCIsIkNsb3NpbmdFbGVtZW50RGV0ZWN0b3IiLCJkZXRlY3RDbG9zaW5nRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsIlhtbEN1cnNvciIsIkRvbVNjYWZmb2xkIiwiY2hpbGREb21TY2FmZm9sZHMiLCJkZXRlY3RvcnMiLCJlbGVtZW50Q3JlYXRlZExpc3RlbmVyIiwibG9hZERlcHRoIiwic2hvd1BvcyIsImVvZiIsImVsZW1lbnREZXRlY3RvciIsImN1ckVsZW1lbnREZXRlY3RvciIsImdldFR5cGUiLCJkZXRlY3QiLCJpc0ZvdW5kIiwid2FybiIsImNyZWF0ZUVsZW1lbnQiLCJhZGRBbGwiLCJjdXJBdHRyaWJ1dGUiLCJwcmV2aW91c1BhcmVudFNjYWZmb2xkIiwiY2hpbGRTY2FmZm9sZCIsInBhcmVudE5vdGlmeVJlc3VsdCIsIm5vdGlmeVJlc3VsdCIsIm5vdGlmeUVsZW1lbnRDcmVhdGVkTGlzdGVuZXIiLCJjaGlsZERvbVNjYWZmb2xkIiwiZ2V0VHJlZSIsImdldENoaWxkRWxlbWVudHMiLCJlbGVtZW50Q3JlYXRlZCIsIkRvbVRyZWUiLCJyb290RWxlbWVudCIsImRvbVNjYWZmb2xkIiwibG9hZCIsImR1bXAiXSwibWFwcGluZ3MiOiIrREFFYUEsV0FFVEMsWUFBWUMsRUFBT0MsRUFBU0MsRUFBUUMsR0FBbUIsR0FDbkQsR0FBSUMsR0FBaUJGLENBQ3JCLEtBQUksR0FBSUcsR0FBSSxFQUFHQSxFQUFJSixFQUFRSyxRQUFVRCxFQUFJTCxFQUFNTSxPQUFTRCxJQUFJLENBQ3hELEtBQU1GLEdBQW9ELEtBQWhDSCxFQUFNTyxPQUFPSCxJQUNuQ0EsR0FFSixJQUFHSixFQUFNTyxPQUFPSCxJQUFtQkgsRUFBUU0sT0FBT0YsR0FHOUMsT0FBUSxDQUZSRCxLQU1S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
